<?xml version="1.0" encoding="utf-8"?>
<mdscript name="GettingAJob" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="../../xsd/md.xsd">
  <cues>
    <cue name="GAJ" namespace="this" version="1">
      <conditions>
        <check_any>
          <event_game_loaded />
          <event_game_started />
          <event_player_created />
          <event_cue_signalled cue="md.Setup.Start" />
        </check_any>
      </conditions>
      <actions>
        <set_value name="$MissionRewardReducer" exact="16" />
        <set_value name="$Paycheck" exact="0" />
        <set_value name="$PayInterval" exact="15m" />
        <set_value name="$PayFactor" exact="0.01" comment="% of mission reward added to paycheck" />
        <!--
        GettingAJob.$Factions.{$faction} = table[
          $missionGroup = missiongroup.gaj_factionname,
          $pay = float,
          $payMultipler = float,
          $lastMission = time,
          $totalRewards = int,
          $pensionTier = int,
          $jobOffered = bool,
          $spyOffered = bool,
          $status = string { hired || quit || retired || traitor || spy },
          $active = bool
        ] -->
        <set_value name="$Factions" exact="table[]" /> <!-- table populates when player begins working for a faction -->

        <set_value name="$BasePayTags" exact="table[
          {tag.peaceful} = 25000,
          {tag.police} = 10000,
          {tag.plunder} = 4000
        ]" />
        <set_value name="$BonusTags" exact="table[
          {tag.peaceful} = 0.4,
          {tag.police} = 1,
          {tag.plunder} = 2.5
        ]" />
        <!-- Work Mission Groups -->
        <set_value name="$MissionGroups" exact="table[
          {faction.anoat} = missiongroup.gaj_anoat,
          {faction.ascendancy} = missiongroup.gaj_ascendancy,
          {faction.baobab} = missiongroup.gaj_baobab,
          {faction.blacksun} = missiongroup.gaj_blacksun,
          {faction.bountyhunters} = missiongroup.gaj_bountyhunters,
          {faction.commerceguild} = missiongroup.gaj_commerceguild,
          {faction.corellia} = missiongroup.gaj_corellia,
          {faction.corporate} = missiongroup.gaj_corporate,
          {faction.galempire} = missiongroup.gaj_galempire,
          {faction.hapes} = missiongroup.gaj_hapes,
          {faction.hoersh} = missiongroup.gaj_hoersh,
          {faction.huttcartel} = missiongroup.gaj_huttcartel,
          {faction.huttpirates} = missiongroup.gaj_huttpirates,
          {faction.incom} = missiongroup.gaj_incom,
          {faction.kamino} = missiongroup.gaj_kamino,
          {faction.kuat} = missiongroup.gaj_kuat,
          {faction.mandodw} = missiongroup.gaj_mandodw,
          {faction.mandoraiders} = missiongroup.gaj_mandoraiders,
          {faction.miningguild} = missiongroup.gaj_miningguild,
          {faction.moncal} = missiongroup.gaj_moncal,
          {faction.naboo} = missiongroup.gaj_naboo,
          {faction.newrepublic} = missiongroup.gaj_newrepublic,
          {faction.rebelalliance} = missiongroup.gaj_rebelalliance,
          {faction.rendili} = missiongroup.gaj_rendili,
          {faction.sienar} = missiongroup.gaj_sienar,
          {faction.sith} = missiongroup.gaj_sith,
          {faction.tagge} = missiongroup.gaj_tagge,
          {faction.thebankingclan} = missiongroup.gaj_thebankingclan,
          {faction.tradefederation} = missiongroup.gaj_tradefederation,
          {faction.transgalmeg} = missiongroup.gaj_transgalmeg,
          {faction.twinsuns} = missiongroup.gaj_twinsuns,
          {faction.valarian} = missiongroup.gaj_valarian
        ]" />
        <set_value name="$SetupComplete" exact="false" />
      </actions>
      <cues>
        <cue name="Init">
          <conditions>
            <check_any>
              <event_game_loaded />
              <event_game_started />
              <event_player_created />
              <event_cue_signalled />
            </check_any>
          </conditions>
          <delay exact="2s" />
          <actions>
            <do_if value="not $SetupComplete">
              <signal_cue_instantly cue="InitSetup" />
            </do_if>
            <reset_cue cue="Init" />
          </actions>
          <cues>
            <cue name="InitSetup">
              <conditions>
                <event_cue_signalled />
              </conditions>
              <delay exact="5s" />
              <actions>
                <!-- find factions with ge 12 relation -->
                <do_for_each name="$faction" in="md.$FactionData.keys.list">
                  <do_if value="$faction.relationto.{faction.player} ge 0.0158">
                    <set_value name="$Factions.{$faction}" exact="table[]" />
                    <set_value name="$Factions.{$faction}.$jobOffered" exact="true" />
                    <do_for_each name="$tag" in="$BasePayTags.keys">
                      <get_factions_by_tag tag="$tag" result="$taggedFactions" />
                      <do_if value="$taggedFactions.indexof.{$faction}">
                        <set_value name="$pay" exact="$BasePayTags.{$tag}" />
                        <set_value name="$bonusMultiplier" exact="$BonusTags.{$tag}" />
                        <set_value name="$payFactor" exact="$payFactor.{$tag}" />
                        <break />
                      </do_if>
                    </do_for_each>
                    <set_value name="$Factions.{$faction}.$pay" exact="$pay" />
                    <set_value name="$offer" exact="'Pay: '+$pay+'/'+$PayInterval+' Bonus: '+$bonusMultiplier*100+'%'" />
                    <write_incoming_message highpriority="true" source="$faction.name" title="$faction.name+': Job Offer'" text="'We are please to inform you that we are offering a job to you. Please see one of our station managers to accept the position.\n\n'+$offer" />
                  </do_if>
                </do_for_each>

                <signal_cue_instantly cue="EmergentMissionsSetup" />
                <!-- Complete -->
                <set_value name="$SetupComplete" exact="true" />
                <reset_cue cue="this" />
              </actions>
            </cue>
            <cue name="EmergentMissionsSetup">
              <conditions>
                <event_cue_signalled />
              </conditions>
              <actions>
                <!-- <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.name}"" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]"
                -->
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.anoat}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.ascendancy}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.baobab}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.bountyhunters}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.commerceguild}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.corellia}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.corporate}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.galempire}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.hoersh}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.huttcartel}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.incom}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.kamino}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.kuat}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.mandodw}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.miningguild}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.moncal}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.newrepublic}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.rebelalliance}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.rendili}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.sienar}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.tagge}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.thebankingclan}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.tradefederation}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.transgalmeg}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.twinsuns}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_neutral,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <!-- pirates -->
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.blacksun}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.huttpirates}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.mandoraiders}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.valarian}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <!-- reclusive -->
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.hapes}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.naboo}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <set_value name="md.kuertee_emergent_missions_requirements_by_faction.Requirements.$ByFaction.{faction.sith}" exact="table[
                  $isDisabled                         = false,
                  $mission_escort_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_escort_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_patrol_req_relLevel        = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_patrol_req_repuLevel       = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_raid_req_relLevel          = md.kuertee_emergent_missions.UserSettings.$req_rel_warSubscription,
                  $mission_raid_req_repuLevel         = md.kuertee_emergent_missions.UserSettings.$req_none,
                  $mission_defendPirate_req_relLevel  = md.kuertee_emergent_missions.UserSettings.$req_rel_friend,
                  $mission_defendPirate_req_repuLevel = md.kuertee_emergent_missions.UserSettings.$req_none
                ]" />
                <reset_cue cue="this" />
              </actions>
            </cue>
          </cues>
        </cue>

        <!-- Paycheck -->
        <cue name="IssuePaycheck">
          <conditions>
            <event_cue_signalled />
          </conditions>
          <delay exact="$PayInterval" />
          <actions>
            <do_for_each name="$faction" in="$Factions.keys.list">
              <do_if value="$Factions.{$faction}.$active">
                <signal_cue_instantly cue="md.GalacticBank.Vault.Transfer" param="table[$faction = $faction, $money = $Factions.{$faction}.$pay]" />
                <!-- todo: generate paycheck notification, add ability to disable notifications -->
              </do_if>
            </do_for_each>
            <signal_cue_instantly cue="this" />
          </actions>
        </cue>

        <!-- Manager Conversation -->
        <cue name="Convo_Start">
          <conditions>
            <check_any>
              <event_cue_signalled />
              <check_all>
                <event_conversation_started conversation="default" />
                <check_value value="not @event.object.hasrelation.enemy.{faction.player}" />
                <check_value value="event.object == @player.container.tradenpc" />
                <check_value value="event.object.trueowner != faction.player" />
                <check_value value="event.object.owner.relationto.{faction.player} ge 0.01585" />
              </check_all>
            </check_any>
            <check_value value="player.container.isclass.station" />
          </conditions>
          <actions>
            <do_if value="event.name == 'event_cue_signalled'">
              <set_value name="$manager" exact="@event.param.$manager" />
              <set_value name="$convoOption_isGetHired" exact="@event.param.$convoOption_isGetHired" />
              <set_value name="$convoOption_isBecomeSpy" exact="@event.param.$convoOption_isBecomeSpy" />
            </do_if>
            <do_else>
              <set_value name="$manager" exact="event.object" />
              <set_value name="$faction" exact="$manager.trueowner" />
              <set_value name="$convoOption_isGetHired" exact="false" />
              <set_value name="$convoOption_isBecomeSpy" exact="false" />
              <do_if value="@$Factions.{$faction}.$jobOffered">
                <set_value name="$convoOption_isGetHired" exact="true" />
              </do_if>
              <do_elseif value="@$Factions.{$faction}.$spyOffered">
                <set_value name="$convoOption_isBecomeSpy" exact="true" />
              </do_elseif>
            </do_else>
            <do_if value="
                  event.name == 'event_conversation_started' and @md.ExtendedConversationMenu.Main.exists
                  and
                  (@$convoOption_isGetHired or @$convoOption_isBecomeSpy)
                ">
              <set_value name="md.ExtendedConversationMenu.Main.$convOptions.$kNPCBankLoans" exact="table[
                    $signalCue = Convo_Start,
                    $params = table[$manager = $manager, $convoOption_isGetHired = @$convoOption_isGetHired, $convoOption_isBecomeSpy = @$convoOption_isBecomeSpy]
                  ]" />
            </do_if>
            <do_else>
              <do_if value="$convoOption_isGetHired">
                <add_player_choice text="'Job Offer'" section="GAJ_get_hired" />
              </do_if>
              <do_if value="$convoOption_isBecomeSpy">
                <!-- spy pay logic goes here-->
                <add_player_choice text="'Become a Spy'" section="GAJ_become_spy" />
              </do_if>
            </do_else>
            <reset_cue cue="this" />
          </actions>
        </cue>
        <cue name="Convo_Continue">
          <conditions>
            <event_conversation_next_section sectionprefix="GAJ_" />
          </conditions>
          <actions>
            <set_value name="$faction" exact="event.object.trueowner" />
            <do_if value="event.param == 'GAJ_get_hired'">
              <set_value name="$Factions.{$faction}.$status" exact="'hired'" />
              <set_value name="$Factions.{$faction}.$active" exact="true" />
              <set_value name="$Factions.{$faction}.$missionGroup" exact="$MissionGroups.{$faction}" />
              <set_value name="$Factions.{$faction}.$bonusMultiplier" exact="$MissionGroups.{$faction}" />
              <find_sector name="$sectors" owner="$faction" multiple="true" />
              <set_value name="$sectorMacros" exact="[]" />
              <do_for_each name="$sector" in="$sectors">
                <append_to_list name="$sector.macro" />
              </do_for_each>
              <run_actions ref="md.LIB_Generic.UncoverMap_SectorsAndGates">
                <param name="InitialMap" value="$sectorMacros" />
                <param name="UncoverStationFaction" value="$faction" />
              </run_actions>
              <do_if value="$Paycheck" exact="0">
                <signal_cue_instantly cue="IssuePaycheck" />
              </do_if>
              <set_value name="$Paycheck" operation="add" exact="$Factions.{$faction}.$pay" />
              <!-- todo: <write_incoming_message source="" title="" text=""/> -->
            </do_if>
            <do_elseif value="event.param == 'GAJ_become_spy'">
              <!-- todo: spy acceptance logic goes here -->
            </do_elseif>
            <reset_cue cue="this" />
          </actions>
        </cue>
      </cues>
    </cue>
  </cues>
</mdscript>